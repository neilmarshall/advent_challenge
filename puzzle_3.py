import doctest
from functools import reduce
from operator import __mul__

data = """
    .....#.##......#..##..........#
    ##.#.##..#............##....#..
    ......###...#..............#.##
    .....#..##.#..#......#.#.#..#..
    ..#.......###..#..........#.#..
    ..#..#.##.......##.....#....#..
    .##....##....##.###.....###..#.
    ..##....#...##..#....#.#.#.....
    .....##..###.##...............#
    #.....#..#....#.##...####..#...
    #......#.#....#..#.##....#..#.#
    ##.#...#.#............#......#.
    .#####.......#..#.#....#......#
    ..#.#....#.#.##...#.##...##....
    .....#.#...#..####.##..#.......
    #....#...##.#.#.##.#..##.....#.
    ##.##...#....#...#......#..##..
    ....##...#..#.#...#.#.#.....##.
    ..#....##......##....#.#....#..
    #..#....#....###..#.##....#.#.#
    ..#.#####..##....#....#.....##.
    .#...##.......#...#....#.#...##
    #.#.#.##.......#.....#.#.#....#
    .#.#.....#.......#.......##....
    .#......#....#....#.......##...
    #......#.....#......#..#..#....
    #.#...#...#....##....#.#...#..#
    ....#.....##...#...#..#.#......
    ..#......#..........#...#.#....
    ..#..#......####..##...###.....
    .#.....#...##...#.##........###
    #.#....#..#....#..#.....#.#..#.
    ...##.##.#.#.##...#.....#......
    ##....#.#.#...####.#.#.#.#.....
    .##.........#..#..###..........
    ..##.###.#..#..#....##.....#...
    ##........#..###....#.#..#..#..
    ....#.#.......##..#.#.#.#......
    ....##.....#.........##.......#
    ..#........##.#.........###..##
    ....#..................##..#...
    #...#.#..###..#.....#..#..#...#
    ..#..#.##..#..#.......#.......#
    .....#..##..#....##...........#
    ..##...#........#...#.#.......#
    .........#.#..#.#..#.##.#.###..
    ....#...#..#..#......##....#.#.
    ..#..#.#....#....#..#.####..##.
    ##....#.....#......##.###.#..#.
    #..#..##..###......#.#.#.#...#.
    .......#..##..##...#...#..#....
    ..#.###.#...#....#.##.#.....##.
    .#.#.......##...##...##....#...
    #...#.#.#...#.####..#..##......
    ###..#.##..#..........#...#....
    ##.#.........#..##......####...
    ..##.#..#....#.##..............
    ...#....#.......###............
    ...#.....##....#.#.#.#.......##
    ###.###...#...#...###.##...##..
    #.#....#.##..#.....#.....##.#..
    ...#....#....#.........#....#.#
    ##.#....#........#..#..##.#....
    .#.#..#.......#...##.......#...
    .##...##........#....#.#..#....
    ....#..#.##.###.....#.#........
    .#.#...#.#..#.....#.........#..
    .......#.#.#..##....#.........#
    .##...#....#..#...#........#..#
    ....#....#..#.#..#.#.#....##.##
    ..##....#.....##..#.#...#...#..
    #.##.........#.....#.......#.##
    ...#...##.#.#..........#......#
    ###...#.....#..#.......#####..#
    #.####...##.#.#..#...#.........
    .##.....#.....##..#...##.##....
    .........###...#......##....###
    .#....##...###.#..#...##..#.#.#
    .......#.......#.#...##.#......
    .....#.#........#..##.....##...
    ....#.#.........##.#...##..#.#.
    #..#..#.##..#.##.##.....##.###.
    ..##.........###...#....#....#.
    .###...#..#.##...........#.....
    #..##..........#..........#....
    .....#.#....#..##..#...#.#....#
    ..#.....#.#....#...##.##.......
    ##.....##........#....#..##....
    .#..#.#.........#..#..#........
    .............##....#....#..#...
    ....##....#..#.#.##....###.##.#
    .###..#.....#..#..##..#..##..#.
    ...#..###.......#.#....#..###..
    #.#..#.....#...#......#........
    #..#..............###.#......#.
    ..#....##.#....#.##.#.#...#....
    .........##..#...#.#.......#...
    ........#...#.#....#.....##..#.
    ...#.##..#..#..###..#..#......#
    .....####......#...#....#...#.#
    ...###.#.#......#....#.......#.
    #...##.#....#....##....##.###..
    .......##...##.....#.##.#..#..#
    .....#.#............##...#.####
    .##..#.#.#.#..#.#.#.....#.##...
    .#..####...#.#....#.....#..#...
    ....##..#.#...#..#....#.#......
    ...#......###..#..###..#.....#.
    .#.#.#..##....#...##..#.....#..
    ###....#....#...##.....#...#...
    #.##....#......#...###.........
    .#..#.#...#..#....#....#....#..
    ...............##...####..#..#.
    #.#...........####..#...##.....
    ##.#....#........#......#...##.
    ......#...#...#....#....#.....#
    #......#.............#....###..
    .#...#...##.....#...##.##..#...
    ..#.#......#.#........#........
    .......#..#.#...##..#.#.#......
    ..##...#.##........#....#.#...#
    .....#..#..#........#.#......##
    ....#.#...##............##....#
    .#.#....#.#.#...#...#.##.....#.
    #.#.##...#....#.#.#..#.##..#.#.
    .........####..#...#...#.......
    #..#..####......#..##..#...#...
    .........##..................#.
    .....##.#..##.#.#...#......##..
    ...#....#....#.#.....#...#..#.#
    #...##.#...##...........#..#...
    #..........#.#..#..#.##..#..#.#
    .#...#.##...#.#.#..#.......##..
    .........#...........#..#..#...
    .##...##....#.#......#........#
    #.#...........#....#.......#...
    ##.#.#.......#...###......##..#
    ...###..#.##..##.#.#.......#...
    .#...#..##.#...#........#.....#
    ...#.......#..#..........#.#...
    ..#.#.#.#.....#.#.......#..#..#
    #.##.....#..##...#..###.#....#.
    .......#...........#...#....###
    .......#..#...#.............#..
    #.....###.......#...#........#.
    .#..#..#..#...........#........
    ....#.#...#.#.##.#.#....#.##..#
    .......#..##...##...#...#......
    ...#.....##.###...#.#...##....#
    #..#....#...##......#....##....
    #.#.......#....#.###.##..#..#..
    ..##...........#...#....#......
    .#........#.....#..#..#...#..##
    .....#.#.#..#.......#....#.....
    #..#.#......#......##....#.....
    ##.....................##......
    .##........###..#.........#...#
    ........#.........#..#.........
    .#.##....#.....#...#.........##
    ....##......#.........#........
    ...#.#..#...##.##.#.#..####....
    ..##...........##.#.#....#.....
    .#.....#.#...#..#.......#....#.
    ....#...#......##...#...##.#..#
    ....#..##....#..#.........##.#.
    ..##...##.##....#....##.###...#
    ..#....##..##.#.#.#...#......#.
    ##...#.........#...........#...
    .##....##.#.....#...#.......#..
    ..........##.###.##....###....#
    ..........#..##..#....#.#.##.##
    ........##.#...#.#.#.#...###.#.
    .#......#.#.#...###.#.#.#......
    .........#......#......#...#..#
    ......#.....#.##....##.#####..#
    ..#..##...###.#..........#.#.#.
    .#..#....###.#...#..#....#...##
    ...................#..........#
    ....###.....#...##......#.....#
    #.....#..##.....#.#..........#.
    ..#.......##.#....#..#.##.#...#
    ........##.#..###..#......##...
    #...........##.#...###..#....#.
    ....#...........#.....#.#...#..
    .##..#.#...#...#.##...#..#.....
    #........#.#.#.#.#.#...........
    #..#.....#..#..#.##....#....#.#
    ..#............##....#.#.##...#
    .....###.#....#.#......#.###...
    ...#.....#.#.................#.
    ..#...##..#.#...#...#...#.....#
    .##.#........#..#....##..#..##.
    .#..........#...#.#..#..#.#....
    #.......##.........#.##..#.####
    .#..............#.......##.....
    #......#.##..........#..#......
    ..##...#...#.#...#............#
    .##.##..##..##........##.....#.
    .....#..#.....##...............
    .#..#...##...#...#.....#.......
    #......#...#.......#..##.###.##
    ###..##......##......###....#..
    ....#..........#...#.##.#.....#
    .........#....#..#..#.#..##....
    .....#.....#...........#......#
    .#.......#...#....##...#.##...#
    ..##.#..............#..#...#.#.
    .#..####.#.........#....#....#.
    ..###.#...#..#......#.......###
    .#.#..##...###...#...#.#...#.#.
    ...#..##..###.#..#.....#.##....
    #...###.#...##.....####.....#..
    .#.##...#..#.#..##.....#.......
    ...#.##.....##.....#....#......
    .#...##.....#..###..#..........
    ..........#...#.....#....##.#..
    .......#...#...#...#........#..
    #....##..#...#..##.#.#.....#...
    .#.#..............#..#....#....
    .####.#.#.###......#...#.#....#
    .#...#...##.#...............#.#
    ...#.......##...#...#....##....
    #..........###.##..........##.#
    .......#...#....#.#..#.#....#..
    ....#.##.#...###..#..##.##.....
    ..#.#.#......#.#.......###.....
    #..................#.##....#...
    #.....#..#.#.#..#...#.........#
    ..#..#...#.#.##........#.......
    #..#.#..#..........###...#.#...
    .......#.##....#........##.#...
    .####.#.#...#.#...##.##.....###
    ........#.#...#.#..##...##.....
    ....##.##......#.##.........#..
    .#..#...#.#...........#........
    .......#..........#....#...#...
    ..###.#.###..#..#.....#..##....
    .#..........#.......##...#.....
    .#.....#...#........#...#.##..#
    .#..#.......#..#.......#.#.#...
    ....#..##.#...##...#.#....#....
    .....#.........#..#..#....#....
    ..#.#..##....#..#..##.#.#.....#
    ........#.#...###....#.#.#.....
    .#.....#.......#..###.#........
    .......#...#.#...#...##........
    ##.............#.#.....#.#..#..
    .#....#.......#.#.......#..##..
    #.....#........#..##..##.......
    ...........#.........###......#
    ....#.##...#.#...#...#....#..##
    ......#..##......#......#.##.#.
    ......##....####...###...#.....
    #....#..........#.#.##.....#..#
    ....#.#...........#.#.#.#.#...#
    ....####.....##...#..##..#...#.
    #....#.###..###.....#..###.....
    ..##.........#......#...##.#...
    ..#.....#.#...#.##.#...#..###.#
    ..#.##..##........#.......#.###
    .....#..........#.....#....#...
    .......##..##..###.......#####.
    ..###......#.#....###....##...#
    #..##.....#..###...#.....##.##.
    #..#..##.##.###.####.##.#......
    .#.#......#.##......#..#......#
    ..###.....#.#......#.#.####....
    #..............#..#.#...#.###..
    ...#..#.##..........##.#...#.##
    .#.#.#.........#....#.#..#.....
    ..#.##..#...#..#...#......#....
    .......#...#.##.#.#..#...##..#.
    ..........#.####...#........#.#
    ....#...#....##.#.........#.#..
    ##.#..#.......###....#..#..#.#.
    ..##.....#..#.#.#.####......#..
    .#.....#..........#..#..#.#....
    ......#.#.......#.#...#..#..#..
    ...#...............#....#...#..
    ##.......#.........#.......#...
    ...#.......###...#.#...#.......
    #...###....#....##....#....#...
    ...#....##..#.#.............##.
    .....#.#.#..#......#...#.#..#..
    .##....#..##..#####..##.....##.
    ....##.#.#..#.....#.#...#......
    ...#.....##.#.#..##..#.#.......
    .......#..#..#..........#......
    .......#...#..#.........#.##...
    ..#..#..#...##..#.#....#......#
    ..#....#...#.#......#........#.
    .#...#..#...#.#..........#.....
    #..#...####..#......##.##.#.#..
    .#...#.#...#.#.....#..##.#.....
    ..#.##.#......#.........##...#.
    ###..............#.............
    ...#...###....#..#.............
    .##....#......#..#.....#..#..#.
    .#..........#.....##...#..#....
    ....##..#.#......###.##......#.
    .#..##.#.##.#...##.#......###.#
    #..###.#...###..#........#.#...
    #..#.#.#..#...###.##.##..#..#..
    #.#..#....#.........##......#..
    ....###.....###....#...........
    ....#..##.##....##..#.....#....
    .#.....#....####...#..##.#..###
    .........##..#......#.#...##...
    .##.......#.....#.###.#..#.#..#
    .....#.#...###.....#......####.
    ##.#...#......#.#.#..#.####...#
    .#.##.....#..#..#.............#
    .#..###..#..#......#..##......#
    .......#.#........##.....#.#...
    #....#...#..###..#.#.....#.##..
    .##.....#.#....###..#.....##...
    ...##....#....#...#....#.#.#...
    #####..#...........###....#...#
    .#.......##.##.....#....#......
    .#..#.#...#..#......#...#..#.#.
    ....#.....##...#####..#...#...#
    ###.##...#.#............#....#.
    .....#...#........##.........#.
    """

def count_trees(h, v, data):
    """
    >>> count_trees(1, 3, data)
    276

    >>> reduce(__mul__, (count_trees(x, y, data) for x, y in ((1, 1), (1, 3), (1, 5), (1, 7), (2, 1))))
    7812180000
    """
    data = [row.strip() for row in data.strip().split('\n')]
    tree_count = x = y = 0
    while x < len(data):
        if data[x][y % len(data[0])] == '#':
            tree_count += 1
        x += h
        y += v
    return tree_count

if __name__ == '__main__':
    doctest.testmod(verbose=True)
